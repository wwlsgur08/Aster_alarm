<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Aster Alarm â€“ ë‚˜ë§Œì˜ ë§¤ë ¥ ë²¨ì†Œë¦¬ ìƒì„±í•˜ê¸° (v2.0)</title>
    <link rel="stylesheet" href="./styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <!-- ë³„ìë¦¬ ë°°ê²½ -->
    <div class="starry-background"></div>

    <div class="main-container">
      <!-- ìƒë‹¨ í—¤ë”: ë¡œê³ ì™€ ì„¤ì • ë²„íŠ¼ -->
      <header class="top-header">
        <div class="header-placeholder"></div>
        <div class="logo-container">
          <img src="./images/logo.png" alt="Aster Alarm Logo" class="logo-image">
        </div>
        <button id="settings-toggle" type="button" class="settings-btn" title="ì„¤ì •">
          âš™ï¸
        </button>
      </header>

      <!-- ì œëª© -->
      <h1 class="main-title">ë‚˜ë§Œì˜ ë§¤ë ¥ ë²¨ì†Œë¦¬ ìƒì„±í•˜ê¸°</h1>

      <!-- ìŒì•… í”Œë ˆì´ì–´ -->
      <div class="music-player" id="music-player">
        <div class="player-container">
          <div class="player-info">
            <div class="track-title" id="track-title">ğŸµ ìƒì„±ëœ ìŒì•…ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
            <div class="track-subtitle" id="track-subtitle">ë§¤ë ¥ì„ ì„ íƒí•˜ê³  ìŒì•…ì„ ìƒì„±í•´ë³´ì„¸ìš”</div>
          </div>
          
          <!-- CD ì´ë¯¸ì§€ -->
          <div class="cd-container">
            <img src="./images/cd.png" alt="CD" class="cd-image" id="cd-image">
            <div class="cd-player-buttons">
              <div class="cd-player-button"></div>
              <div class="cd-player-button"></div>
              <div class="cd-player-button"></div>
            </div>
          </div>
          
          <div class="player-controls">
            <button class="play-btn" id="play-btn" disabled>
              <span class="play-icon">â–¶</span>
            </button>
            <button class="download-btn" id="download-btn" disabled>
              <img src="./images/download_icon.png" alt="Download" class="download-icon-img">
            </button>
          </div>
          
          <div class="progress-container">
            <div class="progress-bar" id="progress-bar">
              <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="time-display">
              <span id="current-time">0:00</span>
              <span id="total-time">0:00</span>
            </div>
          </div>
        </div>
        
        <audio id="audio-player" preload="none"></audio>
      </div>

      <!-- ìŠ¤í¬ë¡¤ ì•ˆë‚´ -->
      <div class="scroll-indicator">
        <div class="scroll-text">ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•˜ì—¬ ë§¤ë ¥ì„ ì„ íƒí•˜ì„¸ìš”</div>
        <div class="scroll-arrow">â†“</div>
      </div>

      <!-- ì´ë¦„ ì…ë ¥ -->
      <div class="name-section">
        <label for="user-name" class="input-label">ì´ë¦„</label>
        <input 
          type="text" 
          id="user-name" 
          class="name-input" 
          placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
        />
      </div>

      <!-- ì‹œê°„ ìŠ¬ë¼ì´ë” -->
      <div class="duration-section">
        <label class="input-label">
          ë²¨ì†Œë¦¬ ê¸¸ì´: <span id="duration-display" class="duration-value">1ë¶„ 00ì´ˆ</span>
        </label>
        <input 
          type="range" 
          id="duration_select" 
          class="duration-slider" 
          min="30" 
          max="120" 
          value="60"
        />
      </div>

      <!-- ë§¤ë ¥ ì„ íƒ ì„¹ì…˜ -->
      <div class="charm-section">
        <h2 class="section-title">ë§¤ë ¥ ì„ íƒ</h2>
        <div id="traits-container" class="charm-container"></div>
        
        <!-- ë§¤ë ¥ ì¶”ê°€ ë²„íŠ¼ -->
        <button id="add-trait" type="button" class="add-charm-btn">
          <span class="plus-icon">+</span> ë§¤ë ¥ ì¶”ê°€
        </button>
      </div>

      <!-- ìŒì•… ìƒì„± ë²„íŠ¼ -->
      <button id="generate" type="button" class="generate-btn" disabled>
        <span class="music-icon">ğŸµ</span>
        <span class="btn-text">ìŒì•… ìƒì„±í•˜ê¸°</span>
        <div class="loading-spinner hidden"></div>
      </button>

      <!-- 3D ë³„ìë¦¬ ì¶”ê°€ ë²„íŠ¼ -->
      <button id="send-to-3d" type="button" class="send-3d-btn hidden" disabled>
        <span class="star-icon">âœ¨</span>
        <span class="btn-text">3D ë³„ìë¦¬ì— ì¶”ê°€</span>
      </button>

      <!-- ìƒíƒœ í‘œì‹œ -->
      <div id="gen-status" class="status-display"></div>

      <!-- ì„¤ì • ë²„íŠ¼ì€ í—¤ë”ë°”ë¡œ ì´ë™ -->

      <!-- JSON ê´€ë¦¬ ë²„íŠ¼ë“¤ (ìˆ¨ê¹€) -->
      <div class="json-controls hidden">
        <button id="clear-traits" type="button" class="secondary-btn">ì´ˆê¸°í™”</button>
        <button id="export-json" type="button" class="secondary-btn">JSON ë‚´ë³´ë‚´ê¸°</button>
        <button id="load-json" type="button" class="secondary-btn">JSON ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <textarea id="traits-json" class="json-textarea hidden" rows="6" placeholder='{
  "traits": [
    {"charm_name": "ì¹¨ì°©ì„±", "stage": 6},
    {"charm_name": "ì•ˆì •ê°", "stage": 5}
  ]
}'></textarea>
      </div>
    </div>

    <!-- ì„¤ì • ëª¨ë‹¬ -->
    <div id="settings-modal" class="modal hidden" aria-hidden="true">
      <div class="modal-content settings-modal-content">
        <div class="modal-header">
          <strong>ì„¤ì •</strong>
          <button id="settings-close" type="button" class="close-btn">Ã—</button>
        </div>
        <div class="settings-body">
          <div class="setting-group">
            <label for="api-endpoint" class="setting-label">API ì—”ë“œí¬ì¸íŠ¸</label>
            <input id="api-endpoint" class="setting-input" placeholder="/api/generate" />
          </div>

          <div class="settings-actions">
            <button id="save-settings" type="button" class="save-settings-btn">ì„¤ì • ì €ì¥</button>
          </div>
          
          <div class="settings-info">
            <p class="settings-note">
              ğŸµ <strong>ì¤‘ì•™ ê´€ë¦¬ ì„œë¹„ìŠ¤</strong><br>
              â€¢ API í‚¤ëŠ” ì„œë²„ì—ì„œ ì¤‘ì•™ ê´€ë¦¬ë©ë‹ˆë‹¤<br>  
              â€¢ ë¬´ì œí•œìœ¼ë¡œ ìŒì•…ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤<br>
              â€¢ ë§¤ë ¥ì„ ì¡°í•©í•´ì„œ ë‚˜ë§Œì˜ ë²¨ì†Œë¦¬ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- ë§¤ë ¥ ì„ íƒ ëª¨ë‹¬ -->
    <div id="picker" class="modal hidden" aria-hidden="true">
      <div class="modal-content charm-modal-content">
        <div class="modal-header">
          <strong>ë§¤ë ¥ ì„ íƒí•˜ê¸°</strong>
          <button id="picker-close" type="button" class="close-btn">Ã—</button>
        </div>
        <div class="picker-body">
          <div class="picker-categories" id="picker-categories"></div>
          <div class="picker-charms" id="picker-charms">
            <div class="hint">ì¹´í…Œê³ ë¦¬ë¥¼ í´ë¦­í•˜ë©´ ì„¸ë¶€ ë§¤ë ¥ì´ í‘œì‹œë©ë‹ˆë‹¤.</div>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer">
      <small>Â© Aster Alarm</small>
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script>
      // Firebase ì„¤ì •
      const firebaseConfig = {
        apiKey: "AIzaSyBcl4tKzcneq6yn6mmADC5YzoVGmRnsZbk",
        authDomain: "dinteraction-e0393.firebaseapp.com",
        databaseURL: "https://dinteraction-e0393-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "dinteraction-e0393",
        storageBucket: "dinteraction-e0393.firebasestorage.app",
        messagingSenderId: "845988355289",
        appId: "1:845988355289:web:b5243b16e80bfb9cbf32c8",
        measurementId: "G-QG1QWM3LSC"
      };
      
      // Firebase ì´ˆê¸°í™”
      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();
      console.log('ğŸ”¥ Firebase ì´ˆê¸°í™” ì™„ë£Œ');
      
      // ì „ì—­ìœ¼ë¡œ ë…¸ì¶œ (app.jsì—ì„œ ì‚¬ìš©)
      window.firebaseDatabase = database;
    </script>

    <script type="module" src="./js/app.js"></script>
  </body>
</html>

